<div class="flex-container">
  
  <div class= "left-column">
    <div class="left-column-title">
      <h3><b>Stratigraphic Column Visualization</b></h3>
    </div>
    
    <div class="d3js-container">
      
      <% @textures_to_render.uniq.each do |i| %>
        <%= render i %>
      <% end %>        
        
      <svg class='stratChart'></svg>
    </div>
    
  </div>
  
  <div class="right-column">
    <div class="general-info-wrapper">
      <h3><b>Stratigraphic Column General Information</b></h3>
      <div class="general-info" data-stratid= "<%= @strat_column.id%>">
        <p><b><%= @strat_column.name %></b></p>
        <p>Location: <%= @strat_column.location %></p>
        <p>Latitude: <%= @strat_column.lat %> Longitude: <%= @strat_column.lng %> </p>
        <p>Description: <%= @strat_column.description %> </p>
      </div> 
      
      <div class="info-btns">
        <%= link_to edit_strat_column_path(id: @strat_column.id), class: "btn btn-default btn-xs" do %>
          Edit Column Details
        <% end%>
        
        <!--https://stackoverflow.com/questions/18492617/button-to-download-inpage-svg-code-as-an-svg-file-->
        <a class="btn btn-default btn-xs" href="javascript:(function () { var e = document.createElement('script'); if (window.location.protocol === 'https:') { e.setAttribute('src', 'https://rawgit.com/NYTimes/svg-crowbar/gh-pages/svg-crowbar.js'); } else { e.setAttribute('src', 'http://nytimes.github.com/svg-crowbar/svg-crowbar.js'); } e.setAttribute('class', 'svg-crowbar'); document.body.appendChild(e); })();">
          â‡© Download SVG
        </a>   
        
        <%= link_to strat_column_path(@strat_column.id), method: :delete, data: { confirm: 'Are you sure you want to delete this column?'}, class: 'btn btn-default btn-xs' do %>
          <i>Delete Column</i>
        <% end %>
        
        <button class="btn btn-default btn-xs" data-toggle="collapse" data-target="#help">Help</button>
        <div id="help" class="collapse help-prompt">
          <p> Note: The download button uses svg-crowbar.js to provide the user access to every SVG element in the DOM. </p>
          <p> The window labeled stratChart contains all the elements inside the chart including fill patterns whereas the 
          unlabeled windows contain individual fill patterns in SVG format.  These patterns were derived from <a href="http://pubs.usgs.gov/tm/2006/11A02/">FDGC's digital cartographic standard</a> and compiled/converted into SVG format by the
          <a href="https://blogs.otago.ac.nz/si-geology/resources/illustrationgraphics-resources/usgs-inkscape-pack-instructions-and-download-link/">University of Otago</a>. </p>
          <p> A tip; you can modify the column using a browser's developer tools before downloading the SVG image.  Changes done to the column before
              downloading the image will be reflected on the downloaded SVG file!  
          </p>
          <p> To get out of the download prompt, please refresh the page.</p>
        </div>
        
      </div>  
    </div> <!--general info-->
    
    <div class="layer-info-wrapper">
      <h3><b>Strata Characteristics and Information</b></h3>
      
      <div class="panel-group">
        <% @layers.each_with_index do |layer, i| %>
          
          <div class="layer-info panel panel-default">
          
            <div class="panel-heading">
              <h4 class="panel-title">
                <a data-toggle="collapse" href="#collapse<%=i%>"> <b>Stratum #<%= i+1 %></b> </a>
              </h4>
              <% if i == 0 %>
                <span class="tooltips glyphicon glyphicon-question-sign"><span>Click to collapse/expand!</span></span>
              <% end %>
            </div> <!-- panel heading end-->
            
            <div id="collapse<%=i%>" class="layer-info-sub panel-collapse collapse">
              <div class="panel-body">
                <p>Lithology: <%= layer.name %> </p>
                <p>Formation: <%= layer.formation %> </p>
                <p>Period: <%= layer.timescale.interval_name%></p>
                <p>Epoch or Age: <%= layer.epoch_age%></p>
                <p>Geologic Contact: <%= layer.contact.name %></p>
                <p>Thickness(m): <%= layer.thickness %> </p>
                <p>Characteristics: <%= layer.description %> </p>
              </div>
            </div> <!-- collapse panel end-->
            
          </div> <!-- panel end --> 
        <% end %>
      </div>
      
    </div>
    
  </div> <!--right-column end-->
</div> <!--flex container-->
